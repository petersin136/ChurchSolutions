@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --bg: #F2F2F7;
    --surface: #FFFFFF;
    --surface2: #F9F9FB;
    --blue: #007AFF;
    --blue-light: #E8F2FF;
    --blue-dark: #0056CC;
    --green: #34C759;
    --green-light: #E8F9ED;
    --orange: #FF9500;
    --orange-light: #FFF4E5;
    --red: #FF3B30;
    --red-light: #FFE9E8;
    --purple: #AF52DE;
    --purple-light: #F4EAFA;
    --teal: #5AC8FA;
    --teal-light: #E8F7FE;
    --indigo: #5856D6;
    --indigo-light: #EEEEFE;
    --pink: #FF2D55;
    --pink-light: #FFE5EB;
    --text1: #1C1C1E;
    --text2: #8E8E93;
    --text3: #AEAEB2;
    --border: rgba(60,60,67,0.08);
    --border2: rgba(60,60,67,0.15);
    --sep: rgba(60,60,67,0.06);
    --font: 'Inter', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.04), 0 1px 3px rgba(0,0,0,0.04);
    --shadow-md: 0 2px 8px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
    --shadow-lg: 0 8px 24px rgba(0,0,0,0.08), 0 2px 8px rgba(0,0,0,0.04);
    --shadow-xl: 0 16px 48px rgba(0,0,0,0.12);
    --shadow-card: 0 0.5px 0 rgba(0,0,0,0.04), 0 2px 6px rgba(0,0,0,0.04);
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;
    --radius-full: 9999px;
    --header-h: 56px;
    --tab-h: 64px;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { -webkit-text-size-adjust: 100%; -webkit-font-smoothing: antialiased; }
  body {
    font-family: var(--font);
    font-size: 15px;
    line-height: 1.5;
    color: var(--text1);
    background: var(--bg);
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    padding-bottom: calc(var(--tab-h) + 20px);
  }
  ::-webkit-scrollbar { width: 4px; height: 4px; }
  ::-webkit-scrollbar-thumb { background: var(--text3); border-radius: var(--radius-full); }
  .wheel-column-scroll::-webkit-scrollbar { display: none; }
}

@layer components {
  .app-header {
    position: sticky; top: 0; z-index: 100;
    height: var(--header-h);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 16px;
    background: rgba(255,255,255,0.78);
    backdrop-filter: saturate(180%) blur(20px);
    -webkit-backdrop-filter: saturate(180%) blur(20px);
    border-bottom: 0.5px solid var(--border);
  }
  .tab-bar {
    position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
    height: 64px;
    padding-bottom: env(safe-area-inset-bottom, 0);
    display: flex; align-items: stretch;
    background: #fff;
    border-top: 1px solid #e5e7eb;
    box-sizing: border-box;
  }
  .tab-item {
    flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px;
    font-size: 11px; font-weight: 500; color: #9ca3af;
    background: none; border: none; cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    transition: color 0.15s;
  }
  .tab-item.active { color: #3b82f6; font-weight: 600; }
  .tab-item .tab-icon { display: flex; align-items: center; justify-content: center; line-height: 1; }
  .tab-item .tab-label { line-height: 1; }
  .page { display: none; max-width: 960px; margin: 0 auto; padding: 16px; }
  .page.active { display: block; }
  #page-finance.page { max-width: 100%; padding: 0; margin: 0; }
  #page-pastoral.page { max-width: 100%; padding: 0; margin: 0; }
  #page-planner.page { max-width: 100%; padding: 0; margin: 0; }
  #page-visit.page { max-width: 100%; padding: 0; margin: 0; }
  #page-bulletin.page { max-width: 100%; padding: 0; margin: 0; }
  .btn {
    display: inline-flex; align-items: center; justify-content: center; gap: 6px;
    font-family: var(--font); font-size: 13px; font-weight: 600; line-height: 1;
    padding: 8px 16px; border: none; border-radius: var(--radius-full);
    cursor: pointer; transition: all 0.15s; white-space: nowrap;
    -webkit-tap-highlight-color: transparent; user-select: none;
  }
  .btn:active { transform: scale(0.96); }
  .btn-primary { background: var(--blue); color: #FFF; box-shadow: 0 2px 8px rgba(0,122,255,0.3); }
  .btn-primary:hover { background: var(--blue-dark); }
  .btn-secondary { background: var(--blue-light); color: var(--blue); }
  .btn-success { background: var(--green); color: #FFF; }
  .btn-danger { background: var(--red-light); color: var(--red); }
  .btn-ghost { background: transparent; color: var(--blue); padding: 8px; }
  .btn-ghost:hover { background: var(--blue-light); }
  .btn-icon { width: 36px; height: 36px; padding: 0; border-radius: var(--radius-md); font-size: 17px; }
  .btn-sm { font-size: 11px; padding: 6px 12px; }
  .btn-lg { font-size: 15px; padding: 12px 24px; border-radius: var(--radius-md); }
  .card {
    background: var(--surface); border-radius: var(--radius-lg);
    box-shadow: var(--shadow-card); overflow: hidden; margin-bottom: 16px;
  }
  .card-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 14px 16px; border-bottom: 0.5px solid var(--sep);
  }
  .card-body { padding: 0; }
  .card-body-padded { padding: 16px; }
  .segment {
    display: flex; background: rgba(118,118,128,0.12);
    border-radius: var(--radius-sm); padding: 2px; margin-bottom: 16px;
    overflow-x: auto; scrollbar-width: none;
  }
  .segment::-webkit-scrollbar { display: none; }
  .segment button {
    flex: 1; min-width: fit-content; padding: 7px 14px;
    font-family: var(--font); font-size: 13px; font-weight: 500;
    color: var(--text1); background: transparent; border: none;
    border-radius: 7px; cursor: pointer; white-space: nowrap;
    transition: all 0.15s; -webkit-tap-highlight-color: transparent;
  }
  .segment button.active {
    background: var(--surface); box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    font-weight: 600; color: var(--blue);
  }
  .stats-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(130px,1fr));
    gap: 10px; margin-bottom: 16px;
  }
  .stat {
    background: var(--surface); border-radius: var(--radius-lg);
    padding: 14px; box-shadow: var(--shadow-card);
    position: relative; overflow: hidden; transition: transform 0.15s;
  }
  .stat:hover { transform: translateY(-1px); }
  .stat::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
  .stat.s-blue::before { background: var(--blue); }
  .stat.s-green::before { background: var(--green); }
  .stat.s-orange::before { background: var(--orange); }
  .stat.s-red::before { background: var(--red); }
  .stat.s-purple::before { background: var(--purple); }
  .stat.s-teal::before { background: var(--teal); }
  .stat .s-icon { font-size: 20px; margin-bottom: 4px; }
  .stat .s-val { font-size: 22px; font-weight: 700; letter-spacing: -0.5px; }
  .stat .s-lbl { font-size: 11px; color: var(--text2); font-weight: 500; }
  .badge {
    display: inline-flex; align-items: center; padding: 3px 10px;
    border-radius: var(--radius-full); font-size: 11px; font-weight: 600;
  }
  .badge-blue { background: var(--blue-light); color: var(--blue); }
  .badge-green { background: var(--green-light); color: var(--green); }
  .badge-orange { background: var(--orange-light); color: var(--orange); }
  .badge-red { background: var(--red-light); color: var(--red); }
  .badge-gray { background: rgba(142,142,147,0.12); color: var(--text2); }
  .badge-purple { background: var(--purple-light); color: var(--purple); }
  .search-box .ico { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text3); font-size: 13px; pointer-events: none; }
  .search-box input {
    width: 100%; height: 38px; padding: 0 14px 0 34px;
    font-family: var(--font); font-size: 13px;
    background: rgba(118,118,128,0.12); border: none; border-radius: var(--radius-md);
    color: var(--text1); outline: none;
  }
  .search-box input::placeholder { color: var(--text3); }
  .search-box input:focus { background: rgba(118,118,128,0.18); }
  select.flt {
    height: 38px; padding: 0 28px 0 12px;
    font-family: var(--font); font-size: 13px;
    background: rgba(118,118,128,0.12); border: none; border-radius: var(--radius-md);
    color: var(--text1); outline: none; cursor: pointer;
    -webkit-appearance: none; appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238E8E93' stroke-width='2.5'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
    background-repeat: no-repeat; background-position: right 8px center;
  }
  .tbl-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  table.tbl { width: 100%; border-collapse: collapse; font-size: 13px; }
  table.tbl thead th {
    padding: 10px 14px; text-align: left; font-weight: 600;
    font-size: 11px; color: var(--text2); text-transform: uppercase;
    letter-spacing: 0.5px; background: var(--surface2);
    border-bottom: 0.5px solid var(--border); white-space: nowrap;
    position: sticky; top: 0; z-index: 1;
  }
  table.tbl tbody tr { transition: background 0.1s; cursor: pointer; }
  table.tbl tbody tr:hover { background: rgba(0,122,255,0.04); }
  table.tbl tbody td {
    padding: 10px 14px; border-bottom: 0.5px solid var(--sep);
    vertical-align: middle; white-space: nowrap;
  }
  table.tbl tbody tr:last-child td { border-bottom: none; }
  .avatar {
    width: 34px; height: 34px; border-radius: var(--radius-full);
    display: inline-flex; align-items: center; justify-content: center;
    font-size: 13px; font-weight: 600; flex-shrink: 0; overflow: hidden;
    background: linear-gradient(135deg, var(--blue-light), var(--teal-light));
    color: var(--blue);
  }
  .avatar img { width: 100%; height: 100%; object-fit: cover; }
  .name-cell { display: flex; align-items: center; gap: 10px; }
  .name-cell .info strong { font-weight: 600; font-size: 13px; }
  .name-cell .info small { font-size: 11px; color: var(--text2); display: block; }
  .att-dot {
    width: 10px; height: 10px; border-radius: var(--radius-full);
    display: inline-block; cursor: pointer; transition: transform 0.15s cubic-bezier(0.34,1.56,0.64,1);
  }
  .att-dot:hover { transform: scale(1.4); }
  .att-dot.p { background: var(--green); box-shadow: 0 0 4px rgba(52,199,89,0.4); }
  .att-dot.a { background: var(--red); box-shadow: 0 0 4px rgba(255,59,48,0.3); }
  .att-dot.l { background: var(--orange); box-shadow: 0 0 4px rgba(255,149,0,0.3); }
  .att-dot.n { background: var(--border2); }
  .week-grid { display: flex; gap: 3px; flex-wrap: wrap; margin-bottom: 12px; }
  .week-cell {
    width: 22px; height: 22px; border-radius: 4px;
    font-size: 9px; font-weight: 600;
    display: flex; align-items: center; justify-content: center; cursor: pointer;
    background: rgba(118,118,128,0.08); color: var(--text3); transition: all 0.15s;
  }
  .week-cell.active { background: var(--blue); color: #FFF; box-shadow: 0 1px 4px rgba(0,122,255,0.3); }
  .modal-bg {
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
    display: flex; align-items: flex-end; justify-content: center;
    opacity: 0; visibility: hidden; transition: all 0.25s;
  }
  .modal-bg.open { opacity: 1; visibility: visible; }
  .modal {
    width: 100%; max-width: 560px; max-height: 92vh;
    background: var(--surface);
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    overflow: hidden; display: flex; flex-direction: column;
    transform: translateY(100%); transition: transform 0.35s cubic-bezier(0.25,0.46,0.45,0.94);
  }
  .modal-bg.open .modal { transform: translateY(0); }
  .modal-handle { width: 36px; height: 5px; border-radius: var(--radius-full); background: rgba(60,60,67,0.15); margin: 8px auto 4px; flex-shrink: 0; }
  .modal-head {
    display: flex; align-items: center; justify-content: space-between;
    padding: 12px 20px; border-bottom: 0.5px solid var(--sep); flex-shrink: 0;
  }
  .modal-x {
    width: 28px; height: 28px; border-radius: var(--radius-full);
    background: rgba(118,118,128,0.12); border: none; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px; color: var(--text2);
  }
  .modal-body { flex: 1; overflow-y: auto; padding: 20px; -webkit-overflow-scrolling: touch; }
  .modal-foot {
    padding: 12px 20px; border-top: 0.5px solid var(--sep);
    display: flex; gap: 8px; justify-content: flex-end; flex-shrink: 0;
  }
  .fg { margin-bottom: 16px; }
  .fl { display: block; font-size: 12px; font-weight: 600; color: var(--text2); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.3px; }
  .fi, .fs, .ft {
    width: 100%; padding: 10px 14px; font-family: var(--font); font-size: 15px;
    background: var(--surface2); border: 1.5px solid var(--border);
    border-radius: var(--radius-md); color: var(--text1); outline: none; transition: all 0.15s;
  }
  .fi:focus, .fs:focus, .ft:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(0,122,255,0.12); }
  .ft { resize: vertical; min-height: 72px; }
  .fi::placeholder, .ft::placeholder { color: var(--text3); }
  .fg-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .upload-area {
    border: 2px dashed var(--border2); border-radius: var(--radius-md);
    padding: 20px; text-align: center; cursor: pointer; transition: all 0.15s;
    background: var(--surface2);
  }
  .upload-area:hover { border-color: var(--blue); background: var(--blue-light); }
  .upload-area .ua-icon { font-size: 28px; margin-bottom: 4px; opacity: 0.5; }
  .upload-area .ua-text { font-size: 13px; color: var(--text2); }
  .img-preview { width: 72px; height: 72px; border-radius: var(--radius-md); object-fit: cover; border: 2px solid var(--border); margin-top: 8px; }
  .toast-box { position: fixed; top: calc(var(--header-h) + 12px); left: 50%; transform: translateX(-50%); z-index: 2000; display: flex; flex-direction: column; gap: 8px; pointer-events: none; }
  .toast {
    background: var(--text1); color: #FFF; padding: 10px 20px;
    border-radius: var(--radius-full); font-size: 13px; font-weight: 500;
    box-shadow: var(--shadow-lg); pointer-events: auto;
    animation: tIn 0.25s cubic-bezier(0.34,1.56,0.64,1) forwards;
    display: flex; align-items: center; gap: 8px;
  }
  .toast.t-ok { background: var(--green); }
  .toast.t-err { background: var(--red); }
  .toast.t-warn { background: var(--orange); }
  .toast.out { animation: tOut 0.15s forwards; }
  @keyframes tIn { from { opacity:0; transform:translateY(-12px) scale(0.9); } to { opacity:1; transform:translateY(0) scale(1); } }
  @keyframes tOut { to { opacity:0; transform:translateY(-8px) scale(0.9); } }
  .note-item {
    background: var(--surface2); border-radius: var(--radius-md);
    padding: 12px; border-left: 3px solid var(--blue); margin-bottom: 10px;
  }
  .note-item .nd { font-size: 11px; color: var(--text3); font-weight: 500; margin-bottom: 2px; }
  .note-item .nc { font-size: 13px; line-height: 1.6; }
  .note-item.prayer { border-left-color: var(--purple); }
  .empty { text-align: center; padding: 40px 16px; }
  .empty .e-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.3; }
  .empty .e-title { font-size: 17px; font-weight: 600; margin-bottom: 4px; }
  .empty .e-desc { font-size: 13px; color: var(--text2); }
  .fin-row {
    display: flex; align-items: center; justify-content: space-between;
    padding: 12px 16px; border-bottom: 0.5px solid var(--sep);
    transition: background 0.1s; cursor: pointer;
  }
  .fin-row:hover { background: rgba(0,122,255,0.04); }
  .fin-row:last-child { border-bottom: none; }
  .fin-row .fr-left { display: flex; align-items: center; gap: 12px; }
  .fin-row .fr-icon {
    width: 36px; height: 36px; border-radius: var(--radius-md);
    display: flex; align-items: center; justify-content: center; font-size: 18px;
  }
  .fin-row .fr-name { font-weight: 500; font-size: 14px; }
  .fin-row .fr-date { font-size: 11px; color: var(--text2); }
  .fin-row .fr-amount { font-weight: 700; font-size: 15px; letter-spacing: -0.3px; }
  .fin-row .fr-amount.income { color: var(--blue); }
  .fin-row .fr-amount.expense { color: var(--red); }
  .budget-bar {
    height: 6px; background: rgba(118,118,128,0.12);
    border-radius: var(--radius-full); overflow: hidden; margin-top: 6px;
  }
  .budget-bar .fill {
    height: 100%; border-radius: var(--radius-full);
    transition: width 0.5s cubic-bezier(0.25,0.46,0.45,0.94);
  }
  .plan-item {
    display: flex; gap: 12px; padding: 12px 16px;
    border-bottom: 0.5px solid var(--sep); cursor: pointer; transition: background 0.1s;
  }
  .plan-item:hover { background: rgba(0,122,255,0.04); }
  .plan-item .pi-time { font-size: 12px; color: var(--text2); font-weight: 500; min-width: 50px; padding-top: 2px; }
  .plan-item .pi-bar { width: 3px; border-radius: var(--radius-full); flex-shrink: 0; }
  .plan-item .pi-bar.c-purple { background: var(--purple); }
  .plan-item .pi-bar.c-blue { background: var(--blue); }
  .plan-item .pi-bar.c-gray { background: var(--text3); }
  .plan-item .pi-bar.c-green { background: var(--green); }
  .plan-item .pi-bar.c-orange { background: var(--orange); }
  .plan-item .pi-content { flex: 1; }
  .plan-item .pi-title { font-weight: 600; font-size: 14px; }
  .plan-item .pi-sub { font-size: 12px; color: var(--text2); }
  .sermon-status {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 11px; font-weight: 600; padding: 3px 8px;
    border-radius: var(--radius-full);
  }
  .d-row {
    display: flex; align-items: flex-start; gap: 12px;
    padding: 10px 14px; background: var(--surface2);
    border-radius: var(--radius-md); margin-bottom: 8px;
  }
  .d-row .d-icon { font-size: 17px; flex-shrink: 0; }
  .d-row .d-label { font-size: 11px; color: var(--text2); font-weight: 500; }
  .d-row .d-value { font-size: 13px; margin-top: 1px; }

  /* 날짜 입력 iOS 스타일 (사이트 전체) */
  input[type="date"],
  input.input-date-ios[type="date"] {
    font-size: 17px;
    font-family: var(--font);
    color: var(--text1);
    padding: 12px 14px;
    padding-right: 12px;
    border-radius: var(--radius-md);
    border: 1px solid var(--border2);
    background: var(--surface);
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    -webkit-appearance: none;
    appearance: none;
    color-scheme: light;
  }
  input[type="date"]:focus,
  input.input-date-ios[type="date"]:focus {
    border-color: var(--blue);
    box-shadow: 0 0 0 3px rgba(0,122,255,0.15);
  }
  input[type="date"]::-webkit-calendar-picker-indicator {
    opacity: 0.6;
    cursor: pointer;
    padding: 4px;
    margin-left: 4px;
  }
  input[type="date"]::-webkit-date-and-time-value {
    text-align: left;
  }
}

@media (min-width: 640px) {
  .modal-bg { align-items: center; }
  .modal { border-radius: var(--radius-xl); max-height: 85vh; transform: translateY(30px) scale(0.95); opacity: 0; }
  .modal-bg.open .modal { transform: translateY(0) scale(1); opacity: 1; }
}
@media (max-width: 768px) {
  .stats-grid { grid-template-columns: repeat(2,1fr); }
  .fg-row { grid-template-columns: 1fr; }
}
@media (max-width: 480px) {
  .stat .s-val { font-size: 18px; }
  .stat { padding: 10px; }
  .week-cell { width: 18px; height: 18px; font-size: 8px; }
}
@media print {
  .app-header, .tab-bar, .btn, .modal-bg, .search-wrap, .segment { display: none !important; }
  body { background: #fff; padding: 0; }
  .page { display: block !important; }
  .card { box-shadow: none; border: 1px solid #ddd; }
}
