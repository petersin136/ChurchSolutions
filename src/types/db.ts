export interface Settings {
  churchName: string;
  depts: string;
  fiscalStart: string;
}

export interface Member {
  id: string;
  name: string;
  dept?: string;
  role?: string;
  birth?: string;
  gender?: string;
  phone?: string;
  address?: string;
  family?: string;
  status?: string;
  source?: string;
  prayer?: string;
  memo?: string;
  group?: string;
  photo?: string;
  createdAt?: string;
}

export type AttStatus = "p" | "a" | "n";

export interface Note {
  date: string;
  type: "memo" | "prayer" | "visit" | "event";
  content: string;
  createdAt: string;
}

export interface Plan {
  id: string;
  title: string;
  date: string;
  time?: string;
  cat: string;
  memo?: string;
}

export interface Sermon {
  id: string;
  date: string;
  service: string;
  text?: string;
  title?: string;
  core?: string;
  status: string;
  notes?: string;
}

export interface Visit {
  id: string;
  date: string;
  memberId: string;
  type: string;
  content: string;
}

export interface Income {
  id: string;
  date: string;
  type: string;
  amount: number;
  donor?: string;
  method?: string;
  memo?: string;
}

export interface Expense {
  id: string;
  date: string;
  category: string;
  item?: string;
  amount: number;
  resolution?: string;
  memo?: string;
}

export interface ChecklistItem {
  text: string;
  done: boolean;
}

export interface DB {
  settings: Settings;
  members: Member[];
  attendance: Record<string, Record<number, AttStatus>>;
  /** 결석 사유: memberId -> weekNum -> 사유 텍스트 */
  attendanceReasons?: Record<string, Record<number, string>>;
  notes: Record<string, Note[]>;
  plans: Plan[];
  sermons: Sermon[];
  visits: Visit[];
  income: Income[];
  expense: Expense[];
  budget: Record<string, number>;
  checklist: Record<string, ChecklistItem[]>;
}

export const DEFAULT_SETTINGS: Settings = {
  churchName: "",
  depts: "유아부,유치부,유년부,초등부,중등부,고등부,청년부,장년부",
  fiscalStart: "1",
};

export const DEFAULT_DB: DB = {
  settings: { ...DEFAULT_SETTINGS },
  members: [],
  attendance: {},
  attendanceReasons: {},
  notes: {},
  plans: [],
  sermons: [],
  visits: [],
  income: [],
  expense: [],
  budget: {},
  checklist: {},
};

/* ===== 70명 샘플 데이터 생성 ===== */
export function buildSampleDB(): DB {
  const td = new Date();
  const ds = (d: Date) => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
  const ago = (days: number) => { const x = new Date(td); x.setDate(x.getDate() - days); return ds(x); };

  // [name, dept, role, birth, gender, phone, address, family, status, prayer, memo]
  type R = [string,string,string,string,string,string,string,string,string,string,string];
  const raw: R[] = [
    /* ── 장년부 (35명) ── */
    ["김영수","장년부","장로","1958-03-15","M","010-1234-5678","서울시 강남구 역삼동 123-4","부인 이순자 권사","active","교회 건축을 위한 기도","당회 서기, 재정위원"],
    ["박성호","장년부","장로","1962-07-22","M","010-2345-6781","서울시 서초구 반포동 456-7","부인 최미영 권사","active","선교사 파송을 위한 기도","당회장"],
    ["이재문","장년부","장로","1955-11-03","M","010-3456-7892","서울시 송파구 잠실동 789-1","부인 오정미 집사","active","건강 회복 기도","원로장로"],
    ["정대현","장년부","안수집사","1972-04-18","M","010-4567-8903","서울시 마포구 상암동 321-5","부인 황지영 집사","active","자녀 신앙교육","주차 봉사팀장"],
    ["한상철","장년부","안수집사","1975-09-10","M","010-5678-9014","서울시 용산구 이태원동 654-2","부인 안미라 집사","active","사업 축복 기도","봉사위원"],
    ["강민호","장년부","안수집사","1968-01-25","M","010-6789-0125","서울시 광진구 자양동 987-3","부인 장민아 집사","active","어머니 건강 회복","선교위원"],
    ["조병구","장년부","안수집사","1965-06-14","M","010-7890-1236","서울시 강동구 천호동 147-8","부인 서영진 집사","active","은퇴 후 사역 준비","시설관리"],
    ["이순자","장년부","권사","1960-02-28","F","010-8901-2347","서울시 강남구 역삼동 123-4","남편 김영수 장로","active","손주들의 건강과 신앙","여전도회 회장"],
    ["최미영","장년부","권사","1964-12-05","F","010-9012-3458","서울시 서초구 반포동 456-7","남편 박성호 장로","active","남편의 건강 회복","구역장 (1구역)"],
    ["송옥순","장년부","권사","1958-08-17","F","010-0123-4569","서울시 종로구 삼청동 258-1","남편 故 김형철 장로","active","자녀들의 신앙성장","원로권사, 기도팀"],
    ["박은실","장년부","권사","1966-05-30","F","010-1111-2222","서울시 성동구 성수동 369-4","남편 류현수 집사","active","교회 부흥을 위한 기도","구역장 (2구역)"],
    ["정양숙","장년부","권사","1970-10-11","F","010-2222-3333","서울시 강남구 대치동 471-2","남편 정대현 안수집사","active","다음 세대 사역 기도","주일학교 교장"],
    ["오정미","장년부","권사","1963-03-20","F","010-3333-4444","서울시 송파구 잠실동 789-1","남편 이재문 장로","active","남편 건강 회복","찬양대 지휘"],
    ["한경자","장년부","권사","1957-09-08","F","010-4444-5555","서울시 중구 필동 582-6","독거","active","외로움 극복, 건강","새벽기도 인도"],
    ["임윤정","장년부","권사","1969-07-12","F","010-5555-6666","서울시 마포구 연남동 193-7","남편 권태호 집사","active","가정의 평안","꽃꽂이 봉사"],
    ["윤서현","장년부","집사","1978-04-22","F","010-6666-7777","서울시 서초구 방배동 847-3","남편 신동수 집사","active","자녀 학업, 가정 화목","교육부 교사"],
    ["황지영","장년부","집사","1982-11-15","F","010-7777-8888","서울시 마포구 상암동 321-5","남편 정대현 안수집사","active","직장에서의 신앙생활","영상팀"],
    ["신동수","장년부","집사","1980-08-03","M","010-8888-9999","서울시 서초구 방배동 847-3","부인 윤서현 집사","active","사업 안정 기도","음향 봉사"],
    ["안미라","장년부","집사","1977-02-14","F","010-9999-0000","서울시 용산구 이태원동 654-2","남편 한상철 안수집사","active","자녀 진로 결정","안내 봉사"],
    ["류현수","장년부","집사","1974-06-28","M","010-1010-2020","서울시 성동구 성수동 369-4","부인 박은실 권사","active","건강 회복 기도","주차 봉사"],
    ["홍선미","장년부","집사","1979-01-19","F","010-2020-3030","서울시 광진구 화양동 753-1","남편 홍재민 (미신자)","active","남편 구원 기도","식사 봉사팀"],
    ["서영진","장년부","집사","1976-12-07","F","010-3030-4040","서울시 강동구 천호동 147-8","남편 조병구 안수집사","active","시어머니 간병","구역 봉사"],
    ["권태호","장년부","집사","1971-03-16","M","010-4040-5050","서울시 마포구 연남동 193-7","부인 임윤정 권사","active","은퇴 준비 기도","재정위원"],
    ["장민아","장년부","집사","1983-09-24","F","010-5050-6060","서울시 광진구 자양동 987-3","남편 강민호 안수집사","active","자녀 건강 기도","유치부 교사"],
    ["김성진","장년부","집사","1978-05-11","M","010-6060-7070","서울시 송파구 문정동 264-9","부인 이미경 집사","active","직장 승진 기도","청년부 후원"],
    ["이미경","장년부","집사","1981-08-20","F","010-7070-8080","서울시 송파구 문정동 264-9","남편 김성진 집사","active","자녀 교육 기도","초등부 교사"],
    ["박철수","장년부","집사","1973-10-05","M","010-8080-9090","서울시 강남구 개포동 518-3","부인 김수진 (미등록)","active","아내 교회 정착 기도","안내 봉사팀장"],
    ["최은정","장년부","집사","1975-07-17","F","010-9090-0101","서울시 서초구 양재동 392-1","남편 최재현 (사별)","active","자녀 양육 기도, 건강","성가대"],
    ["송미경","장년부","집사","1969-04-09","F","010-0101-1212","서울시 종로구 부암동 471-5","남편 사업 부도","active","남편 사업 회복, 가정 화목","중보기도팀"],
    ["김철수","장년부","성도","1985-02-18","M","010-1212-2323","서울시 강남구 역삼동 891-2","미혼","active","결혼 상대 기도","안내 봉사"],
    ["이영희","장년부","성도","1987-06-30","F","010-2323-3434","서울시 서초구 서초동 736-4","미혼","active","직장 안정 기도","안내 봉사"],
    ["이정훈","장년부","새가족","1988-11-22","M","010-3434-4545","서울시 마포구 합정동 582-7","부인 김미선","active","새 교회 정착 기도","이전교회: 사랑의교회"],
    ["김미선","장년부","새가족","1990-03-14","F","010-4545-5656","서울시 마포구 합정동 582-7","남편 이정훈","active","임신 중 건강 기도","이전교회: 사랑의교회"],
    ["한지우","장년부","집사","1980-12-01","F","010-5656-6767","서울시 용산구 한남동 248-9","남편 한지수 집사","active","선교 헌신 기도","선교위원"],
    ["한지수","장년부","집사","1978-08-25","M","010-6767-7878","서울시 용산구 한남동 248-9","부인 한지우 집사","active","가정 예배 정착","재정위원"],
    /* ── 청년부 (12명) ── */
    ["김동현","청년부","청년","1998-05-12","M","010-7878-8989","서울시 관악구 봉천동 192-3","","active","취업 준비 기도","청년부 회장"],
    ["이수빈","청년부","청년","2000-09-03","F","010-8989-9090","서울시 동작구 사당동 473-8","","active","고시 합격 기도","찬양팀"],
    ["박서연","청년부","청년","1999-01-28","F","010-9191-0202","서울시 강남구 역삼동 561-2","부모 교인","active","유학 준비 기도","영상팀"],
    ["최지훈","청년부","청년","1997-07-15","M","010-0303-1414","서울시 서초구 잠원동 318-5","","active","군 전역 후 진로 기도","봉사팀장"],
    ["정하나","청년부","새가족","2001-04-20","F","010-1515-2626","서울시 송파구 석촌동 627-4","","active","새 교회 정착 기도","2주째 출석"],
    ["강민지","청년부","청년","2002-11-08","F","010-2626-3737","서울시 마포구 서교동 482-1","부모 교인","active","대학 생활 적응 기도","유년부 교사"],
    ["조현우","청년부","청년","1996-03-22","M","010-3737-4848","서울시 광진구 구의동 193-7","","active","대학원 논문 기도","청년부 부회장"],
    ["윤예린","청년부","청년","2003-08-14","F","010-4848-5959","서울시 성동구 왕십리 584-2","부모 교인","active","신앙 성장 기도","찬양팀"],
    ["장시우","청년부","청년","1998-12-01","M","010-5959-6060","서울시 중구 신당동 275-3","","active","사업 시작 기도","청년 예배 인도"],
    ["임다은","청년부","청년","2000-06-17","F","010-6161-7272","서울시 강동구 명일동 841-6","부모 교인","active","공무원 시험 합격 기도","중등부 교사"],
    ["한태우","청년부","청년","1999-10-30","M","010-7272-8383","서울시 송파구 방이동 193-4","","active","군 제대 후 복귀 적응","새벽기도 출석"],
    ["오채원","청년부","청년","2001-02-05","F","010-8383-9494","서울시 강남구 논현동 472-8","부모 교인","active","진로 결정 기도","고등부 교사"],
    /* ── 고등부 (5명) ── */
    ["김하준","고등부","학생","2008-04-11","M","010-1234-5678","서울시 강남구 역삼동 123-4","부모: 김영수 장로","active","수능 준비 기도","김영수 장로 손자"],
    ["이서아","고등부","학생","2009-08-23","F","010-9012-3458","서울시 서초구 반포동 456-7","부모: 박성호 장로","active","학업 집중 기도",""],
    ["박도윤","고등부","학생","2008-11-17","M","010-8080-9090","서울시 강남구 개포동 518-3","부모: 박철수 집사","active","대학 진학 기도",""],
    ["최수아","고등부","학생","2009-05-02","F","010-9090-0101","서울시 서초구 양재동 392-1","부모: 최은정 집사","active","음악 전공 기도","성가대 반주"],
    ["정건우","고등부","학생","2010-01-19","M","010-4567-8903","서울시 마포구 상암동 321-5","부모: 정대현 안수집사","active","체육 특기 기도",""],
    /* ── 중등부 (5명) ── */
    ["강지호","중등부","학생","2011-03-08","M","010-6789-0125","서울시 광진구 자양동 987-3","부모: 강민호 안수집사","active","학업 기도",""],
    ["조아인","중등부","학생","2012-07-14","F","010-7890-1236","서울시 강동구 천호동 147-8","부모: 조병구 안수집사","active","친구관계 기도",""],
    ["윤서윤","중등부","학생","2011-09-25","F","010-6666-7777","서울시 서초구 방배동 847-3","부모: 윤서현 집사","active","성적 향상 기도",""],
    ["장현서","중등부","학생","2012-02-11","M","010-5050-6060","서울시 광진구 자양동 987-3","부모: 장민아 집사","active","신앙 성장 기도",""],
    ["임하은","중등부","학생","2013-06-20","F","010-5555-6666","서울시 마포구 연남동 193-7","부모: 임윤정 권사","active","학교 적응 기도",""],
    /* ── 초등부 (5명) ── */
    ["한민서","초등부","학생","2014-04-03","F","010-5656-6767","서울시 용산구 한남동 248-9","부모: 한지우 집사","active","",""],
    ["오지안","초등부","학생","2015-10-18","M","010-8383-9494","서울시 강남구 논현동 472-8","부모: 오채원 청년(이모)","active","",""],
    ["서은우","초등부","학생","2016-01-27","M","010-3030-4040","서울시 강동구 천호동 147-8","부모: 서영진 집사","active","",""],
    ["신시아","초등부","학생","2015-05-09","F","010-8888-9999","서울시 서초구 방배동 847-3","부모: 신동수 집사","active","",""],
    ["권도현","초등부","학생","2014-12-14","M","010-4040-5050","서울시 마포구 연남동 193-7","부모: 권태호 집사","active","",""],
    /* ── 유년부 (3명) ── */
    ["홍예은","유년부","학생","2018-03-22","F","010-2020-3030","서울시 광진구 화양동 753-1","부모: 홍선미 집사","active","",""],
    ["류하윤","유년부","학생","2019-08-15","F","010-1010-2020","서울시 성동구 성수동 369-4","부모: 류현수 집사","active","",""],
    ["김지율","유년부","학생","2018-11-03","M","010-6060-7070","서울시 송파구 문정동 264-9","부모: 김성진 집사","active","",""],
    /* ── 유치부 (3명) ── */
    ["정하율","유치부","학생","2020-05-17","M","010-4567-8903","서울시 마포구 상암동 321-5","부모: 정대현 안수집사","active","",""],
    ["이서진","유치부","학생","2021-02-08","F","010-7070-8080","서울시 송파구 문정동 264-9","부모: 이미경 집사","active","",""],
    ["박지안","유치부","학생","2020-09-30","F","010-8080-9090","서울시 강남구 개포동 518-3","부모: 박철수 집사","active","",""],
    /* ── 유아부 (2명) ── */
    ["김시온","유아부","영아","2022-07-12","M","010-6060-7070","서울시 송파구 문정동 264-9","부모: 김성진 집사","active","",""],
    ["이하린","유아부","영아","2023-01-20","F","010-3434-4545","서울시 마포구 합정동 582-7","부모: 이정훈 새가족","active","",""],
  ];

  const members: Member[] = raw.map((r, i) => ({
    id: `m${i + 1}`, name: r[0], dept: r[1], role: r[2], birth: r[3], gender: r[4],
    phone: r[5], address: r[6], family: r[7], status: r[8], prayer: r[9], memo: r[10],
    source: ["새가족","영아"].includes(r[2]) || r[0] === "이정훈" || r[0] === "김미선" ? "새가족" : "기존",
    createdAt: ago(Math.floor(Math.random() * 365)),
  }));

  /* ── 10개 목장 배정 ── */
  const MOKJANG: Record<string, string[]> = {
    "믿음목장": ["m1","m8","m10","m14","m30","m31","m48"],
    "소망목장": ["m2","m9","m12","m15","m49","m50","m51"],
    "사랑목장": ["m3","m13","m21","m29","m40","m54","m57"],
    "은혜목장": ["m4","m17","m16","m18","m52","m55","m61"],
    "감사목장": ["m5","m19","m34","m35","m46","m58","m64"],
    "평강목장": ["m6","m24","m11","m20","m53","m56","m62"],
    "기쁨목장": ["m7","m22","m27","m28","m65","m68","m69"],
    "열매목장": ["m25","m26","m23","m32","m33","m67","m70"],
    "빛과소금목장": ["m36","m37","m38","m39","m41","m59","m60"],
    "새싹목장": ["m42","m43","m44","m45","m47","m63","m66"],
  };
  for (const [gName, ids] of Object.entries(MOKJANG)) {
    for (const mid of ids) {
      const mbr = members.find(x => x.id === mid);
      if (mbr) mbr.group = gName;
    }
  }

  /* 출석 데이터 (최근 8주) */
  const wn = (() => { const n = new Date(), s = new Date(n.getFullYear(), 0, 1); return Math.ceil(((n.getTime() - s.getTime()) / 864e5 + s.getDay() + 1) / 7); })();
  const attendance: Record<string, Record<number, AttStatus>> = {};
  const adultIds = members.filter(m => !["유아부","유치부"].includes(m.dept || "")).map(m => m.id);
  for (const mid of adultIds) {
    attendance[mid] = {};
    for (let w = wn - 7; w <= wn; w++) {
      const r = Math.random();
      attendance[mid][w] = r < 0.75 ? "p" : r < 0.92 ? "a" : "n";
    }
  }

  /* 노트 (기도제목·메모·심방·경조사 — 70명 분포) */
  const notes: Record<string, Note[]> = {};
  const noteData: [string, string, string, string][] = [
    ["m1", "prayer", "교회 건축 헌금 서약: 월 50만원", ago(14)],
    ["m1", "memo", "당회에서 건축위원장 추대", ago(7)],
    ["m2", "prayer", "선교사 파송을 위한 기도", ago(5)],
    ["m3", "visit", "원로장로 자택 심방 - 건강 양호", ago(21)],
    ["m3", "prayer", "건강 회복, 무릎 통증 완화", ago(10)],
    ["m4", "prayer", "이순자 권사 무릎 관절 수술 예정", ago(10)],
    ["m5", "prayer", "사업 축복 기도", ago(8)],
    ["m6", "prayer", "어머니 건강 회복", ago(12)],
    ["m7", "prayer", "은퇴 후 사역 준비", ago(6)],
    ["m8", "prayer", "손주들의 건강과 신앙", ago(4)],
    ["m9", "visit", "1구역 모임 참석 독려 심방", ago(5)],
    ["m9", "prayer", "남편의 건강 회복", ago(3)],
    ["m10", "prayer", "자녀들의 신앙성장", ago(11)],
    ["m11", "prayer", "교회 부흥을 위한 기도", ago(9)],
    ["m12", "prayer", "다음 세대 사역 기도", ago(7)],
    ["m14", "prayer", "한경자 권사 독거 - 정기 안부 전화 필요", ago(3)],
    ["m14", "memo", "독거 어르신 정기 연락 배정", ago(2)],
    ["m17", "prayer", "가정의 평안", ago(15)],
    ["m18", "prayer", "직장에서의 신앙생활", ago(4)],
    ["m19", "prayer", "사업 안정 기도", ago(8)],
    ["m20", "prayer", "자녀 진로 결정", ago(6)],
    ["m21", "memo", "홍선미 집사 - 남편 전도 집중 기도 요청", ago(8)],
    ["m21", "prayer", "남편 구원 기도", ago(5)],
    ["m27", "visit", "박철수 집사 가정 심방 - 아내 교회 등록 권유", ago(12)],
    ["m27", "prayer", "아내 교회 정착 기도", ago(3)],
    ["m28", "prayer", "최은정 집사 사별 후 심리상담 연계 필요", ago(6)],
    ["m28", "memo", "자녀 돌봄 지원 논의", ago(4)],
    ["m29", "memo", "송미경 집사 - 구제비 50만원 당회 승인", ago(15)],
    ["m29", "prayer", "가정에 평안과 지혜", ago(2)],
    ["m32", "event", "이정훈/김미선 새가족 등록 완료", ago(18)],
    ["m32", "prayer", "새 교회 정착 기도", ago(10)],
    ["m33", "memo", "김미선 - 출산예정일 6월, 심방 예정", ago(4)],
    ["m33", "prayer", "건강한 출산 기도", ago(2)],
    ["m37", "prayer", "김동현 청년 - 삼성전자 면접 합격 기도", ago(2)],
    ["m37", "memo", "취업 멘토링 연결 (김성진 집사)", ago(9)],
    ["m41", "memo", "정하나 청년 - 새가족반 수료, 청년부 배정", ago(9)],
    ["m41", "prayer", "새 교회 정착", ago(5)],
    ["m46", "prayer", "한태우 청년 - 군 제대 후 신앙 회복 중", ago(11)],
    ["m46", "memo", "청년부 소그룹 3조 배정", ago(7)],
    ["m49", "prayer", "수능 준비 기도", ago(6)],
    ["m52", "prayer", "학업 집중 기도", ago(4)],
    ["m59", "prayer", "유학 준비 기도", ago(8)],
    ["m63", "prayer", "가정 예배 정착", ago(3)],
  ];
  for (const [mid, type, content, date] of noteData) {
    if (!notes[mid]) notes[mid] = [];
    notes[mid].push({ date, type: type as Note["type"], content, createdAt: date });
  }

  /* 심방 기록 — 70명과 연동, 목장별 분포 */
  const visitRows: [string, string, string, string][] = [
    [ago(2), "m3", "정기", "이재문 장로 자택 심방. 건강 양호하나 무릎 통증 호소. 기도 후 격려."],
    [ago(5), "m14", "위로", "한경자 권사 독거 심방. 외로움 호소. 구역 모임 참석 권유."],
    [ago(8), "m29", "위로", "송미경 집사 가정 심방. 남편 사업 어려움. 구제비 전달 및 기도."],
    [ago(18), "m32", "새가족", "이정훈/김미선 가정 첫 심방. 등록카드 작성. 이전교회 사랑의교회."],
    [ago(4), "m27", "정기", "박철수 집사 가정 방문. 아내 김수진씨 교회 등록 의사 표현."],
    [ago(11), "m28", "위로", "최은정 집사 사별 1주기. 심리상담 연계. 자녀 돌봄 지원 논의."],
    [ago(21), "m8", "병문안", "이순자 권사 무릎 수술 예정 병원 방문. 수술일 3/5 확정."],
    [ago(1), "m1", "정기", "김영수 장로 월례 심방. 건축 헌금 서약 확인. 당회 서기 역할 점검."],
    [ago(6), "m2", "정기", "박성호 장로 자택. 선교 사역 논의. 필리핀 단기선교 참여 의사."],
    [ago(9), "m4", "병문안", "이순자 권사 무릎 수술 후 회복 확인. 재가정 예정."],
    [ago(12), "m9", "정기", "최미영 권사 1구역 모임 참석 독려 심방."],
    [ago(15), "m10", "위로", "송옥순 권사 원로 권사 격려. 자녀 신앙 성장 기도."],
    [ago(3), "m11", "정기", "박은실 권사 구역장 사역 점검. 교회 부흥 기도 제목 나눔."],
    [ago(7), "m12", "정기", "정양숙 권사 주일학교 교장 심방. 다음 세대 사역 논의."],
    [ago(14), "m13", "정기", "오정미 권사 찬양대 지휘 격려. 잠실동 자택."],
    [ago(10), "m15", "위로", "한경자 권사 독거 정기 안부. 새벽기도 인도 격려."],
    [ago(16), "m17", "정기", "윤서현 집사 교육부 교사 사역. 자녀 학업 기도."],
    [ago(19), "m18", "정기", "황지영 집사 영상팀 봉사 점검. 직장 신앙생활 나눔."],
    [ago(13), "m19", "정기", "신동수 집사 음향 봉사. 사업 안정 기도."],
    [ago(20), "m20", "병문안", "안미라 집사 자녀 진로 상담. 가정 화목 기도."],
    [ago(22), "m21", "정기", "류현수 집사 주차 봉사. 건강 회복 기도."],
    [ago(17), "m22", "정기", "홍선미 집사 남편 구원 기도. 식사 봉사팀 격려."],
    [ago(24), "m23", "정기", "서영진 집사 구역 봉사. 시어머니 간병 상황 나눔."],
    [ago(23), "m25", "정기", "권태호 집사 재정위원. 은퇴 준비 기도."],
    [ago(26), "m26", "정기", "장민아 집사 유치부 교사. 자녀 건강 기도."],
    [ago(25), "m30", "정기", "김성진 집사 청년부 후원. 직장 승진 기도."],
    [ago(27), "m33", "새가족", "김미선 출산 예정 심방. 산모 교실 안내."],
    [ago(28), "m37", "정기", "김동현 청년 취업 준비. 면접 합격 기도."],
    [ago(30), "m41", "새가족", "정하나 청년 새가족반 수료. 청년부 배정 완료."],
    [ago(29), "m46", "정기", "한태우 청년 군 제대 후 신앙 회복. 소그룹 연결."],
    [ago(31), "m49", "정기", "이서아 고등부 학생 학업 집중 기도."],
    [ago(32), "m52", "정기", "강지호 중등부 학업 기도. 부모 강민호 집사 동반."],
    [ago(33), "m55", "정기", "조아인 중등부 친구관계 기도."],
    [ago(34), "m59", "정기", "박서연 청년 유학 준비 기도."],
    [ago(35), "m63", "정기", "한민서 초등부 가정 심방. 부모 한지우 집사."],
  ];
  const visits: Visit[] = visitRows.map(([date, memberId, type, content], i) => ({
    id: `sv${i + 1}`,
    date,
    memberId,
    type,
    content,
  }));

  /* 수입 (최근 3개월) */
  const income: Income[] = [];
  const incTypes = ["십일조","감사헌금","주정헌금","선교헌금","건축헌금","특별헌금"];
  const donorMembers = members.filter(m => (m.role || "").match(/장로|권사|안수집사|집사|성도/) && m.dept === "장년부");
  for (let mo = 0; mo < 3; mo++) {
    const md = new Date(td); md.setMonth(md.getMonth() - mo);
    const ms = `${md.getFullYear()}-${String(md.getMonth()+1).padStart(2,"0")}`;
    for (const dm of donorMembers) {
      const numOff = 1 + Math.floor(Math.random() * 2);
      for (let k = 0; k < numOff; k++) {
        const cat = incTypes[Math.floor(Math.random() * incTypes.length)];
        const amts = [50000,100000,150000,200000,300000,500000,800000,1000000];
        income.push({
          id: `inc-${mo}-${dm.id}-${k}`, date: `${ms}-${String(1+Math.floor(Math.random()*28)).padStart(2,"0")}`,
          type: cat, amount: amts[Math.floor(Math.random() * amts.length)],
          donor: dm.name, method: ["현금","계좌이체","온라인"][Math.floor(Math.random()*3)],
        });
      }
    }
  }

  /* 지출 (최근 3개월) */
  const expense: Expense[] = [];
  const expCats = ["인건비","선교비","교육비","시설관리비","사무비","행사비","구제비"];
  const expItems: Record<string,string[]> = {
    "인건비": ["목사 사례비","전도사 사례비","사무장 급여"],
    "선교비": ["김OO 선교사 후원","필리핀 단기선교","선교대회 지원"],
    "교육비": ["주일학교 교재","겨울성경학교 준비","교사 세미나"],
    "시설관리비": ["냉난방비","수도/전기","건물 수리"],
    "사무비": ["사무용품","인쇄/복사","통신비"],
    "행사비": ["성탄절 행사","부활절 행사","야외예배"],
    "구제비": ["긴급 구제","장학금","경로잔치"],
  };
  for (let mo = 0; mo < 3; mo++) {
    const md = new Date(td); md.setMonth(md.getMonth() - mo);
    const ms = `${md.getFullYear()}-${String(md.getMonth()+1).padStart(2,"0")}`;
    for (const cat of expCats) {
      const items = expItems[cat] || ["기타"];
      const numE = 1 + Math.floor(Math.random() * 2);
      for (let k = 0; k < numE; k++) {
        const amts = [100000,200000,300000,500000,800000,1000000,1500000,2000000,3000000];
        expense.push({
          id: `exp-${mo}-${cat}-${k}`, date: `${ms}-${String(1+Math.floor(Math.random()*28)).padStart(2,"0")}`,
          category: cat, item: items[Math.floor(Math.random() * items.length)],
          amount: amts[Math.floor(Math.random() * amts.length)],
        });
      }
    }
  }

  return {
    settings: { churchName: "은혜교회", depts: "유아부,유치부,유년부,초등부,중등부,고등부,청년부,장년부", fiscalStart: "1" },
    members, attendance, attendanceReasons: {}, notes, plans: [], sermons: [], visits, income, expense, budget: {}, checklist: {},
  };
}

export const CATS_INCOME = [
  "십일조",
  "감사헌금",
  "주정헌금",
  "선교헌금",
  "건축헌금",
  "특별헌금",
  "기타수입",
];
export const CATS_EXPENSE = [
  "인건비",
  "선교비",
  "교육비",
  "시설관리비",
  "사무비",
  "행사비",
  "구제비",
  "기타",
];
export const PLAN_CATS: Record<string, string> = {
  "예배/설교": "c-purple",
  "심방/상담": "c-blue",
  "회의/행정": "c-gray",
  "행사/교육": "c-green",
  "개인/경건": "c-orange",
};
export const SERMON_STATUS_COLORS: Record<string, string> = {
  구상중: "badge-gray",
  본문연구: "badge-blue",
  초고작성: "badge-orange",
  수정중: "badge-purple",
  완료: "badge-green",
};
export const DEFAULT_CHECKLIST = [
  "주보 내용 확인",
  "찬양 곡 선정 확인",
  "교사 배치 확인",
  "새가족 환영 준비",
  "봉사자 배치 확인",
  "설교 최종 점검",
  "기도제목 정리",
  "심방 일정 확인",
];
